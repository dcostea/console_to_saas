<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Console2SAAS</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Console2SAAS</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#console-to-saas"><span class="toc-section-number">1</span> Console to SAAS</a>
<ul>
<li><a href="#on-premise-solution"><span class="toc-section-number">1.1</span> On premise solution</a></li>
<li><a href="#scaling"><span class="toc-section-number">1.2</span> Scaling</a></li>
<li><a href="#download-the-book-for-free"><span class="toc-section-number">1.3</span> Download the book for free</a></li>
<li><a href="#source-codes"><span class="toc-section-number">1.4</span> Source codes</a></li>
<li><a href="#feedback"><span class="toc-section-number">1.5</span> Feedback</a></li>
</ul></li>
<li><a href="#the-boss-that-is-hurrying-up-proof-of-concept--source-code"><span class="toc-section-number">2</span> The boss that is hurrying up: proof of concept + source code</a>
<ul>
<li><a href="#technical-analysis"><span class="toc-section-number">2.1</span> Technical analysis</a></li>
<li><a href="#exercise"><span class="toc-section-number">2.2</span> Exercise</a></li>
<li><a href="#impact-to-the-solution"><span class="toc-section-number">2.3</span> Impact to the solution</a></li>
<li><a href="#code"><span class="toc-section-number">2.4</span> Code</a></li>
<li><a href="#download-code"><span class="toc-section-number">2.5</span> Download code</a></li>
<li><a href="#further-reading"><span class="toc-section-number">2.6</span> Further reading</a></li>
</ul></li>
<li><a href="#financial-department-last-tweaks-mvp--fixing-bugs-source-control"><span class="toc-section-number">3</span> Financial department last tweaks: MVP + fixing bugs, source control</a>
<ul>
<li><a href="#technical-analysis-1"><span class="toc-section-number">3.1</span> Technical analysis</a></li>
<li><a href="#exercise-1"><span class="toc-section-number">3.2</span> Exercise</a></li>
<li><a href="#code-1"><span class="toc-section-number">3.3</span> Code</a></li>
<li><a href="#download-code-1"><span class="toc-section-number">3.4</span> Download code</a></li>
<li><a href="#further-reading-1"><span class="toc-section-number">3.5</span> Further reading</a></li>
</ul></li>
<li><a href="#second-internal-customer-sharing-code-source--settings-for-client"><span class="toc-section-number">4</span> Second internal customer: sharing code source + settings for client</a>
<ul>
<li><a href="#technical-analysis-2"><span class="toc-section-number">4.1</span> Technical analysis</a></li>
<li><a href="#exercise-2"><span class="toc-section-number">4.2</span> Exercise</a></li>
<li><a href="#technicalwhy"><span class="toc-section-number">4.3</span> (Technical)Why</a></li>
<li><a href="#code-2"><span class="toc-section-number">4.4</span> Code</a></li>
<li><a href="#download-code-2"><span class="toc-section-number">4.5</span> Download code</a></li>
<li><a href="#further-reading-2"><span class="toc-section-number">4.6</span> Further reading</a></li>
</ul></li>
<li><a href="#transform-to-product-making-a-gui"><span class="toc-section-number">5</span> Transform to product: making a GUI</a>
<ul>
<li><a href="#technical-analysis-3"><span class="toc-section-number">5.1</span> Technical analysis</a></li>
<li><a href="#exercise-3"><span class="toc-section-number">5.2</span> Exercise</a></li>
<li><a href="#impact-to-the-solution-1"><span class="toc-section-number">5.3</span> Impact to the solution</a></li>
<li><a href="#code-3"><span class="toc-section-number">5.4</span> Code</a></li>
<li><a href="#download-code-3"><span class="toc-section-number">5.5</span> Download code</a></li>
<li><a href="#further-reading-3"><span class="toc-section-number">5.6</span> Further reading</a></li>
</ul></li>
</ul>
</nav>
<section id="console-to-saas" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Console to SAAS</h1>
<p>This book will guide you step-by-step how you can build a scalable product from a <a href="https://en.wikipedia.org/wiki/Proof_of_concept">proof of concept</a> to a production ready <a href="https://en.wikipedia.org/wiki/Software_as_a_service">SAAS</a>. Any development done will start from a business need: this will make things clear for the team what is the impact of the delivery. You will see different arhitecture patterns for <a href="https://en.wikipedia.org/wiki/Separation_of_concerns">separation of concerns</a> and why some of them fit well and some of them not. Everything will happen incrementally and the product development history will be easy to be seen by analyzing commits. To have our finished product, we will see the two development directions:</p>
<section id="on-premise-solution" data-number="1.1">
<h2 data-number="1.1"><span class="header-section-number">1.1</span> On premise solution</h2>
<ul>
<li>how the idea get a shape</li>
<li>creating the PoC</li>
<li>bug fixing</li>
<li>componentization / testing / refactoring</li>
<li>unit and integration testing</li>
<li>extending functionalities</li>
</ul>
</section>
<section id="scaling" data-number="1.2">
<h2 data-number="1.2"><span class="header-section-number">1.2</span> Scaling</h2>
<ul>
<li>authentication</li>
<li>load testing</li>
<li>profiling and optimisations</li>
<li>continuous deployment</li>
<li>tight coupled microservices</li>
<li>messaging systems / loose coupled microservices</li>
<li>third party integrations</li>
</ul>
</section>
<section id="download-the-book-for-free" data-number="1.3">
<h2 data-number="1.3"><span class="header-section-number">1.3</span> Download the book for free</h2>
<p>You can find the code source at <a href="https://github.com/ignatandrei/console_to_saas">https://github.com/ignatandrei/console_to_saas</a></p>
<p>You can read online this book at <a href="https://ignatandrei.github.io/console_to_saas/">https://ignatandrei.github.io/console_to_saas/</a></p>
<p>You can read offline by downloading the</p>
<ol>
<li><a href="https://ignatandrei.github.io/console_to_saas/ConsoleToSaas.pdf">PDF</a></li>
<li><a href="https://ignatandrei.github.io/console_to_saas/ConsoleToSaas.docx">Word</a></li>
<li><a href="https://ignatandrei.github.io/console_to_saas/ConsoleToSaas.epub">Epub</a></li>
<li><a href="https://ignatandrei.github.io/console_to_saas/ConsoleToSaas.odt">ODT</a></li>
</ol>
</section>
<section id="source-codes" data-number="1.4">
<h2 data-number="1.4"><span class="header-section-number">1.4</span> Source codes</h2>
<p>You can find source codes at <a href="https://github.com/ignatandrei/console_to_saas/">Console2SAAS</a> or after each chapter.</p>
</section>
<section id="feedback" data-number="1.5">
<h2 data-number="1.5"><span class="header-section-number">1.5</span> Feedback</h2>
<p>Please share feedback by opening an issue or pull request at <a href="https://github.com/ignatandrei/console_to_saas/">https://github.com/ignatandrei/console_to_saas/</a></p>
</section>
</section>
<section id="the-boss-that-is-hurrying-up-proof-of-concept--source-code" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> The boss that is hurrying up: proof of concept + source code</h1>
<p>True story: one day my boss came and he asked me to have a discussion about how can we help our colleagues from the financial department since they are thinking about automation process. We found a spare place and scheduled a meeting where we find out that 3 employees were manually extracting the client information (name, identity information, address) and contract agreement details (fee, payment schedule) to an Excel file and saving the document in a protected area.</p>
<section id="technical-analysis" data-number="2.1">
<h2 data-number="2.1"><span class="header-section-number">2.1</span> Technical analysis</h2>
<p>After putting some brainstorming and analyzing the constraint we ended up developing a solution that reads from a folder share and continue the process without any human intervention. This would allow to have all our employees to continue their work simultaneously with less effort than before. The prototype solution that we developed was a console app written in C# where we were able to fulfill our requirements in a minimum amount of time.</p>
</section>
<section id="exercise" data-number="2.2">
<h2 data-number="2.2"><span class="header-section-number">2.2</span> Exercise</h2>
<p>Make a Console solution that reads all word documents from a folder , parses and outputs the contents to Excel.. Create and make it work, the easy way. You can find sample data in the folder data in the github project .</p>
</section>
<section id="impact-to-the-solution" data-number="2.3">
<h2 data-number="2.3"><span class="header-section-number">2.3</span> Impact to the solution</h2>
<p>We decided to go with a third-party tool (NPOI) instead of us making a library that parses word documents.</p>
</section>
<section id="code" data-number="2.4">
<h2 data-number="2.4"><span class="header-section-number">2.4</span> Code</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode csharp"><code class="sourceCode cs"><span id="cb1-1"><a href="#cb1-1"></a><span class="dt">string</span> folderWithWordDocs = Console.<span class="fu">ReadLine</span>();</span>
<span id="cb1-2"><a href="#cb1-2"></a>            </span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">//omitted code for clarity</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">foreach</span> (<span class="dt">string</span> file <span class="kw">in</span> Directory.<span class="fu">GetFiles</span>(folderWithWordDocs, <span class="st">&quot;*.docx&quot;</span>))</span>
<span id="cb1-5"><a href="#cb1-5"></a>{</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="co">//omitted code for clarity</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="dt">var</span> contractorDetails = <span class="fu">ExactContractorDetails</span>(document.<span class="fu">Tables</span>[<span class="dv">0</span>]);</span>
<span id="cb1-8"><a href="#cb1-8"></a>    allContractors.<span class="fu">Add</span>(contractorDetails);</span>
<span id="cb1-9"><a href="#cb1-9"></a>}</span></code></pre></div>
<p>As you can see, we were facing resolving the solution for the particular client for the specific situation without having an overview of the overall process or any thoughts to going this idea further. The whole process is a sequence of operations without any control flow involved.</p>
</section>
<section id="download-code" data-number="2.5">
<h2 data-number="2.5"><span class="header-section-number">2.5</span> Download code</h2>
<p>Code at <a href="https://ignatandrei.github.io/console_to_saas/sources/Chapter01.zip">Chapter01</a></p>
</section>
<section id="further-reading" data-number="2.6">
<h2 data-number="2.6"><span class="header-section-number">2.6</span> Further reading</h2>
<p>Read about Gui.cs - <a href="https://github.com/migueldeicaza/gui.cs">https://github.com/migueldeicaza/gui.cs</a></p>
<p>Read about the difference between EnumerateFiles and GetFiles.</p>
<p>Read about Async Enumerable in .NET 3.0</p>
</section>
</section>
<section id="financial-department-last-tweaks-mvp--fixing-bugs-source-control" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Financial department last tweaks: MVP + fixing bugs, source control</h1>
<p>We installed our console app on one of the computers of an employee in the financial department, we set it up and we let it running. After a few days we had some bug fixing and some new requests that came in. We saw an enthusiastic behavior on our colleagues by using our solution and that was our first real feedback that we were resolving a customer pain. We anticipated that we will get more feedback and to track what we have done we needed a source control. After a few iterations, we had our financial department happy and we are ready with our first MVP.</p>
<section id="technical-analysis-1" data-number="3.1">
<h2 data-number="3.1"><span class="header-section-number">3.1</span> Technical analysis</h2>
<p>We decided to have 2 separate projects (a business logic and console) because it is not taking so much time and can be beneficial in the long run. Also, because of the modifications , we need to have a source control - or, at least, to can go back to some version.</p>
</section>
<section id="exercise-1" data-number="3.2">
<h2 data-number="3.2"><span class="header-section-number">3.2</span> Exercise</h2>
<p>Try to refactor the solution from Chapter 1 to extract the business logic( i.e. transforming word files into an excel file) into a separate class.</p>
</section>
<section id="code-1" data-number="3.3">
<h2 data-number="3.3"><span class="header-section-number">3.3</span> Code</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode csharp"><code class="sourceCode cs"><span id="cb2-1"><a href="#cb2-1"></a><span class="dt">var</span> wordExtractor = <span class="kw">new</span> <span class="fu">WordContractExtractor</span>(folderWithWordDocs);</span>
<span id="cb2-2"><a href="#cb2-2"></a>wordExtractor.<span class="fu">ExtractToFile</span>(excelResultsFile);</span></code></pre></div>
<p>Now, we are ready to process any folder very easy, just be instantiating a new class with the directory</p>
</section>
<section id="download-code-1" data-number="3.4">
<h2 data-number="3.4"><span class="header-section-number">3.4</span> Download code</h2>
<p>Code at <a href="https://ignatandrei.github.io/console_to_saas/sources/Chapter02.zip">Chapter02</a></p>
</section>
<section id="further-reading-1" data-number="3.5">
<h2 data-number="3.5"><span class="header-section-number">3.5</span> Further reading</h2>
<p>Version Control : <a href="https://en.wikipedia.org/wiki/Version_control">https://en.wikipedia.org/wiki/Version_control</a></p>
<p>Set also a repository at <a href="http://github.com/">http://github.com/</a> , <a href="https://azure.microsoft.com/en-us/services/devops/">https://azure.microsoft.com/en-us/services/devops/</a> or other online source control.</p>
<p>Refactoring: <a href="https://www.amazon.com/Refactoring-Improving-Design-Existing-Code/dp/0201485672">https://www.amazon.com/Refactoring-Improving-Design-Existing-Code/dp/0201485672</a></p>
</section>
</section>
<section id="second-internal-customer-sharing-code-source--settings-for-client" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Second internal customer: sharing code source + settings for client</h1>
<p>It has been a few months since our financial department is using the application and they were happy with it. On a morning coffee break where we were discussing the new automation trends, they mention the tool that we developed. Sales department was willing to see since they had themselves some similar situation. We configured and deployed on a separate machine for them and we saw great feedback and real usage on a daily basis. They were so excited to see how they decreased the paperwork hours and had more time to pay attention to the clients needs. They want to use the application as an example of automation and we find more suitable as a product development.</p>
<section id="technical-analysis-2" data-number="4.1">
<h2 data-number="4.1"><span class="header-section-number">4.1</span> Technical analysis</h2>
<p>Creating a configuration file with all the settings that a client can particular change. For now we have just the directory path. Along with the config, we have added also a class that manages the reading operation to move the reading operation</p>
</section>
<section id="exercise-2" data-number="4.2">
<h2 data-number="4.2"><span class="header-section-number">4.2</span> Exercise</h2>
<p>Make a Console solution that can read a configurable setting( the folder path to be searched ) from a file instead of being hard coded into the application. Do not over-engineer the solution. Create and make it work, the easy way.</p>
</section>
<section id="technicalwhy" data-number="4.3">
<h2 data-number="4.3"><span class="header-section-number">4.3</span> (Technical)Why</h2>
<p>The reason that we put the setting into a configuration file and not make 2 applications is to have an easy way to maintain the same application for 2 clients. Also, later, the client may want to read from 2 different folders ?</p>
<p>The impact on the solution is minimal. Just create a new class that knows how to read from a config file and retrieve the name of the folder as a property.</p>
</section>
<section id="code-2" data-number="4.4">
<h2 data-number="4.4"><span class="header-section-number">4.4</span> Code</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode csharp"><code class="sourceCode cs"><span id="cb3-1"><a href="#cb3-1"></a><span class="dt">var</span> settings = Settings.<span class="fu">From</span>(<span class="st">&quot;app.json&quot;</span>);</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="dt">var</span> directoryToSearch= settings.<span class="fu">DocumentSLocation</span>;</span></code></pre></div>
</section>
<section id="download-code-2" data-number="4.5">
<h2 data-number="4.5"><span class="header-section-number">4.5</span> Download code</h2>
<p>Code at <a href="https://ignatandrei.github.io/console_to_saas/sources/Chapter03.zip">Chapter03</a></p>
</section>
<section id="further-reading-2" data-number="4.6">
<h2 data-number="4.6"><span class="header-section-number">4.6</span> Further reading</h2>
<p>An application can have multiple sources of configuration. Read about .NET Core endpoint configuration (<a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/servers/kestrel?view=aspnetcore-2.2">https://docs.microsoft.com/en-us/aspnet/core/fundamentals/servers/kestrel?view=aspnetcore-2.2</a> ) : Environment, command line, configuration file, code ( in this order)</p>
<p>Read also about IOptionSnapshot and IOptionMonitor at <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/configuration/options?view=aspnetcore-3.1">https://docs.microsoft.com/en-us/aspnet/core/fundamentals/configuration/options?view=aspnetcore-3.1</a></p>
</section>
</section>
<section id="transform-to-product-making-a-gui" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Transform to product: making a GUI</h1>
<p>At our Digital Transformation Center Department we have recurring meetings with clients that are part of our continuous iterative process to identify things that needs to be improved. In one of the meetups that we hosted on our desk, we invited the financial department to leave feedback on the process that we helped. We talked about how the process evolved and how by adopting Digital Solutions decreased manual work. The presentation ended up with some Q&amp;A and several clients they were interested to have the application installed. At that point we realised that this is real a missing point in the current market and we planned to develop a product around this. At this point we had a validated idea by the market and we decided to evolve based on the client needs. Selling the application to multiple clients means to have configurable the word extracting and location of the documents. We ended up creating a GUI to allow the user to configure himself the automation parameters. This was a valuable feature for our users since most of them could be non technical. Transfer the ownership of the paths from the config file to more appropriate user interface</p>
<section id="technical-analysis-3" data-number="5.1">
<h2 data-number="5.1"><span class="header-section-number">5.1</span> Technical analysis</h2>
<p>Sharing code source from console application to the GUI application in order to not duplicate code Transfer the ownership of the hardcoded paths to an external location. In our case we have the user interface for this Define a user interface (maybe with the progress of the operations ?) Adding logging for knowing what happens if an error occurs Adding exception handling to not crash the application Maybe add some specific code per project ( in our case, assert that user have not entered any folder / maybe list what documents have been successfully processed and what not)</p>
</section>
<section id="exercise-3" data-number="5.2">
<h2 data-number="5.2"><span class="header-section-number">5.2</span> Exercise</h2>
<p>Modify the existing solution to support both Console and GUI.</p>
</section>
<section id="impact-to-the-solution-1" data-number="5.3">
<h2 data-number="5.3"><span class="header-section-number">5.3</span> Impact to the solution</h2>
<p>From a solution with a single project, we have now a solution with 3 projects Business Layer (BL) - logic for the application - in our case, processing documents from a folder Console ( referencing BL) Desktop ( referencing BL)</p>
<p>The BL has the code that was previous in the console application( loading settings, doing extraction) + some new code ( logging, others)</p>
</section>
<section id="code-3" data-number="5.4">
<h2 data-number="5.4"><span class="header-section-number">5.4</span> Code</h2>
<p>The business logic is now more simple:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode csharp"><code class="sourceCode cs"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">ExtractToFile</span>(<span class="dt">string</span> excelFileOutput)</span>
<span id="cb4-2"><a href="#cb4-2"></a>{       </span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="dt">string</span>[] files = Directory.<span class="fu">GetFiles</span>(_documentLocation, <span class="st">&quot;*.docx&quot;</span>);</span>
<span id="cb4-4"><a href="#cb4-4"></a>_logger.<span class="fu">Info</span>($<span class="st">&quot;processing {files.Length} word documents&quot;</span>);</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">//code omitted for brevity</span></span></code></pre></div>
<p>The Console code now is very simple, just calling code from BL:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode csharp"><code class="sourceCode cs"><span id="cb5-1"><a href="#cb5-1"></a><span class="dt">var</span> settings = Settings.<span class="fu">From</span>(<span class="st">&quot;app.json&quot;</span>);</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="dt">var</span> extractor = <span class="kw">new</span> <span class="fu">WordContractExtractor</span>(settings.<span class="fu">DocumentsLocation</span>);</span>
<span id="cb5-3"><a href="#cb5-3"></a>extractor.<span class="fu">Start</span>();</span></code></pre></div>
<p>The Desktop is calling the same BL , with some increased feedback for the user:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode csharp"><code class="sourceCode cs"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">try</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>{</span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="dt">string</span> folder = folderPath.<span class="fu">Text</span>;</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="kw">if</span>(<span class="dt">string</span>.<span class="fu">IsNullOrWhiteSpace</span>(folder))</span>
<span id="cb6-5"><a href="#cb6-5"></a>    {</span>
<span id="cb6-6"><a href="#cb6-6"></a>        MessageBox.<span class="fu">Show</span>(<span class="st">&quot;please choose a folder&quot;</span>);</span>
<span id="cb6-7"><a href="#cb6-7"></a>        <span class="kw">return</span>;</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a>    }</span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="dt">var</span> extractor = <span class="kw">new</span> <span class="fu">WordContractExtractor</span>(folder);</span>
<span id="cb6-11"><a href="#cb6-11"></a>    extractor.<span class="fu">Start</span>();</span>
<span id="cb6-12"><a href="#cb6-12"></a>}</span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="kw">catch</span>(Exception ex)</span>
<span id="cb6-14"><a href="#cb6-14"></a>{</span>
<span id="cb6-15"><a href="#cb6-15"></a>    _logger.<span class="fu">Error</span>(ex,$<span class="st">&quot;exception in  {nameof(StartButton_Click)}&quot;</span>);</span>
<span id="cb6-16"><a href="#cb6-16"></a>    MessageBox.<span class="fu">Show</span>(<span class="st">&quot;an error occured. See the log file for details&quot;</span>);</span>
<span id="cb6-17"><a href="#cb6-17"></a>}</span></code></pre></div>
</section>
<section id="download-code-3" data-number="5.5">
<h2 data-number="5.5"><span class="header-section-number">5.5</span> Download code</h2>
<p>Code at <a href="https://ignatandrei.github.io/console_to_saas/sources/Chapter04.zip">Chapter04</a></p>
</section>
<section id="further-reading-3" data-number="5.6">
<h2 data-number="5.6"><span class="header-section-number">5.6</span> Further reading</h2>
<p>.NET Core 3.0 Windows application ( WPF, WinForms): <a href="https://docs.microsoft.com/en-us/dotnet/core/whats-new/dotnet-core-3-0">https://docs.microsoft.com/en-us/dotnet/core/whats-new/dotnet-core-3-0</a></p>
<p>MultiTier architecture : <a href="https://en.wikipedia.org/wiki/Multitier_architecture">https://en.wikipedia.org/wiki/Multitier_architecture</a></p>
</section>
</section>
</body>
</html>
